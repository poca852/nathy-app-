"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[421],{4421:(w,f,i)=>{i.r(f),i.d(f,{AdminModule:()=>P});var l=i(6895),s=i(5649),u=i(433),C=i(5226),h=i.n(C),e=i(8256),d=i(529),T=i(2340),p=i(8505),g=i(4004),A=i(262),Z=i(9646),y=i(5439);let c=(()=>{class n{constructor(t){this.http=t,this.baseUrl=T.N.baseUrl}get user(){return{...this._user}}login(t){return this.http.post(`${this.baseUrl}/auth/admin/login`,t).pipe((0,p.b)(({token:o})=>{o&&localStorage.setItem("token",o)}),(0,g.U)(o=>o.ok),(0,A.K)(o=>(0,Z.of)(o.error.msg)))}revalidarToken(){const t=(new d.WM).set("x-token",localStorage.getItem("token")||"");return this.http.get(`${this.baseUrl}/auth/revalidar/admin`,{headers:t}).pipe((0,p.b)(({token:o,user:a})=>{this._user=a,localStorage.setItem("token",o)}),(0,g.U)(o=>o.ok),(0,A.K)(o=>(0,Z.of)(!1)))}logout(){this._user=null,localStorage.clear()}getAllRutaByAdmin(){const t=(new d.WM).set("x-token",localStorage.getItem("token")||"");return this.http.get(`${this.baseUrl}/rutas`,{headers:t})}closeRuta(t){const o=(new d.WM).set("x-token",localStorage.getItem("token")||"");return this.http.patch(`${this.baseUrl}/rutas/close/${t}`,{},{headers:o})}openRuta(t){const o=(new d.WM).set("x-token",localStorage.getItem("token")||""),a=y().utc(!0).format("DD/MM/YYYY");return this.http.patch(`${this.baseUrl}/rutas/open/${t}`,{fecha:a},{headers:o})}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(d.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var U=i(1740),v=i(5593);let b=(()=>{class n{constructor(t,o,a){this.fb=t,this.router=o,this.adminService=a,this.formLogin=this.fb.group({username:["",u.kI.required],password:["",u.kI.required]}),this.loading=!1}ngOnInit(){}login(){if(this.loading=!0,this.formLogin.invalid)return h().fire("Error","Por favor Ingresa los datos","error"),void(this.loading=!1);this.adminService.login(this.formLogin.value).subscribe(t=>{!0===t?(this.router.navigateByUrl("/admin/home"),this.loading=!1):(h().fire("Error",t,"error"),this.loading=!1)})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(u.qu),e.Y36(s.F0),e.Y36(c))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-login"]],decls:11,vars:2,consts:[[1,"container"],[3,"formGroup","ngSubmit"],[1,"p-inputgroup"],[1,"p-inputgroup-addon"],[1,"pi","pi-user"],["type","text","pInputText","","formControlName","username","placeholder","Usuario"],[1,"pi","pi-key"],["type","password","pInputText","","formControlName","password","placeholder","Contrase\xf1a"],["pButton","","label","Ingresar","type","submit",3,"disabled"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"form",1),e.NdJ("ngSubmit",function(){return o.login()}),e.TgZ(2,"div",2)(3,"span",3),e._UZ(4,"i",4),e.qZA(),e._UZ(5,"input",5),e.qZA(),e.TgZ(6,"div",2)(7,"span",3),e._UZ(8,"i",6),e.qZA(),e._UZ(9,"input",7),e.qZA(),e._UZ(10,"button",8),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("formGroup",o.formLogin),e.xp6(9),e.Q6J("disabled",o.loading))},dependencies:[U.o,v.Hq,u._Y,u.Fj,u.JJ,u.JL,u.sg,u.u],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;padding-top:100px}.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{border:thin solid rgba(255,255,255,.1);border-radius:5px;gap:10px;padding:20px;display:flex;flex-direction:column;width:300px}@media screen and (max-width: 960px){.container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{width:240px}}"]}),n})();var x=i(3214),_=i(1383);const M=function(){return{position:"fixed",right:0,left:0,top:0,"z-index":88888}};let S=(()=>{class n{constructor(t,o){this.adminService=t,this.router=o,this.openMenu=!1}ngOnInit(){}logout(){this.adminService.logout(),this.router.navigateByUrl("/admin/login")}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(c),e.Y36(s.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-home"]],decls:17,vars:4,consts:[[3,"ngStyle"],[1,"p-toolbar-group-left"],["pButton","","icon","pi pi-bars",1,"p-button-outlined",3,"click"],[1,"p-toolbar-group-right"],["pButton","","icon","pi pi-power-off",1,"p-button-danger",3,"click"],[3,"visible","baseZIndex","visibleChange"],[1,"menu"],["routerLink","./resumen",3,"click"],["routerLink","./nueva-ruta",3,"click"],["routerLink","./nuevo-usuario",3,"click"],["routerLink","./ajustes",3,"click"],[1,"contenedor"]],template:function(t,o){1&t&&(e.TgZ(0,"p-toolbar",0)(1,"div",1)(2,"button",2),e.NdJ("click",function(){return o.openMenu=!o.openMenu}),e.qZA()(),e.TgZ(3,"div",3)(4,"button",4),e.NdJ("click",function(){return o.logout()}),e.qZA()()(),e.TgZ(5,"p-sidebar",5),e.NdJ("visibleChange",function(j){return o.openMenu=j}),e.TgZ(6,"nav",6)(7,"li",7),e.NdJ("click",function(){return o.openMenu=!o.openMenu}),e._uU(8,"Resumen"),e.qZA(),e.TgZ(9,"li",8),e.NdJ("click",function(){return o.openMenu=!o.openMenu}),e._uU(10,"Crear ruta"),e.qZA(),e.TgZ(11,"li",9),e.NdJ("click",function(){return o.openMenu=!o.openMenu}),e._uU(12,"Crear usuario"),e.qZA(),e.TgZ(13,"li",10),e.NdJ("click",function(){return o.openMenu=!o.openMenu}),e._uU(14,"Ajustes"),e.qZA()()(),e.TgZ(15,"div",11),e._UZ(16,"router-outlet"),e.qZA()),2&t&&(e.Q6J("ngStyle",e.DdM(3,M)),e.xp6(5),e.Q6J("visible",o.openMenu)("baseZIndex",1e9))},dependencies:[l.PC,s.lC,s.rH,v.Hq,x.Y,_.o],styles:[".contenedor[_ngcontent-%COMP%]{margin-top:80px}.menu[_ngcontent-%COMP%]{display:flex;gap:10px;flex-direction:column;width:100%}.menu[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{list-style:none;text-align:center;font-size:1.5em}"]}),n})(),m=(()=>{class n{constructor(t,o){this.router=t,this.adminService=o}canActivate(){return this.adminService.revalidarToken().pipe((0,p.b)(t=>{t||this.router.navigateByUrl("/admin/login")}))}canLoad(){return this.adminService.revalidarToken().pipe((0,p.b)(t=>{t||this.router.navigateByUrl("/admin/login")}))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(s.F0),e.LFG(c))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),k=(()=>{class n{constructor(t,o){this.router=t,this.adminService=o}canActivate(){return this.adminService.revalidarToken().pipe((0,p.b)(t=>{t&&this.router.navigateByUrl("/admin/home")}),(0,g.U)(t=>!t))}canLoad(){return this.adminService.revalidarToken().pipe((0,p.b)(t=>{t||this.router.navigateByUrl("/admin/home")}))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(s.F0),e.LFG(c))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var R=i(5108);let O=(()=>{class n{constructor(t){this.adminService=t}ngOnInit(){}closeRuta(){this.adminService.closeRuta(this.ruta.id).subscribe(t=>{!0===t.ok&&window.location.reload()})}openRuta(){this.adminService.openRuta(this.ruta.id).subscribe(t=>{!0===t.ok&&window.location.reload()})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(c))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-panel-ruta"]],inputs:{ruta:"ruta"},decls:54,vars:29,consts:[[1,"card","text-layout"],[1,"flex","flex-column"],[1,"header","flex","flex-row","justify-content-between"],["pButton","",1,"p-button-text",3,"ngClass","label","click"],[1,"content"],[1,"grid"],[1,"col","flex","justify-content-end"],[1,"col","flex","justify-content-start"],[1,"col","flex","jusitfy-content-start"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),e._uU(4),e.qZA(),e.TgZ(5,"button",3),e.NdJ("click",function(){return o.ruta.status?o.closeRuta():o.openRuta()}),e.qZA()(),e._UZ(6,"p-divider"),e.TgZ(7,"div",4)(8,"div",5)(9,"div",6),e._uU(10,"Cartera"),e.qZA(),e.TgZ(11,"div",7),e._uU(12),e.ALo(13,"currency"),e.qZA()(),e.TgZ(14,"div",5)(15,"div",6),e._uU(16,"Clientes"),e.qZA(),e.TgZ(17,"div",8),e._uU(18),e.qZA()(),e.TgZ(19,"div",5)(20,"div",6),e._uU(21,"Gastos"),e.qZA(),e.TgZ(22,"div",8),e._uU(23),e.ALo(24,"currency"),e.qZA()(),e.TgZ(25,"div",5)(26,"div",6),e._uU(27,"Inversiones"),e.qZA(),e.TgZ(28,"div",8),e._uU(29),e.ALo(30,"currency"),e.qZA()(),e.TgZ(31,"div",5)(32,"div",6),e._uU(33,"Retiros"),e.qZA(),e.TgZ(34,"div",8),e._uU(35),e.ALo(36,"currency"),e.qZA()(),e.TgZ(37,"div",5)(38,"div",6),e._uU(39,"T. Recaudado"),e.qZA(),e.TgZ(40,"div",8),e._uU(41),e.ALo(42,"currency"),e.qZA()(),e.TgZ(43,"div",5)(44,"div",6),e._uU(45,"T. Prestado"),e.qZA(),e.TgZ(46,"div",8),e._uU(47),e.ALo(48,"currency"),e.qZA()(),e.TgZ(49,"div",5)(50,"div",6),e._uU(51,"Estado"),e.qZA(),e.TgZ(52,"div",8),e._uU(53),e.qZA()()()()()),2&t&&(e.xp6(4),e.Oqu(o.ruta.nombre),e.xp6(1),e.Q6J("ngClass",o.ruta.status?"p-button-danger":"p-button-success")("label",o.ruta.status?"Cerrar":"Abrir"),e.xp6(7),e.Oqu(e.xi3(13,11,o.ruta.cartera,"GTQ")),e.xp6(6),e.Oqu(o.ruta.clientes),e.xp6(5),e.Oqu(e.xi3(24,14,o.ruta.gastos,"GTQ")),e.xp6(6),e.Oqu(e.xi3(30,17,o.ruta.inversiones,"GTQ")),e.xp6(6),e.Oqu(e.xi3(36,20,o.ruta.retiros,"GTQ")),e.xp6(6),e.Oqu(e.xi3(42,23,o.ruta.total_cobrado,"GTQ")),e.xp6(6),e.Oqu(e.xi3(48,26,o.ruta.total_prestado,"GTQ")),e.xp6(6),e.Oqu(o.ruta.status?"Abierta":"Cerrada"))},dependencies:[l.mk,v.Hq,R.i,l.H9],styles:[".card[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border:thin solid rgba(255,255,255,.1);padding:5px 15px}"]}),n})();var I=i(7932);let L=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-spiner"]],decls:1,vars:0,template:function(t,o){1&t&&e._UZ(0,"p-progressSpinner")},dependencies:[I.G]}),n})();function q(n,r){1&n&&e._UZ(0,"app-panel-ruta",5),2&n&&e.Q6J("ruta",r.$implicit)}function F(n,r){if(1&n&&(e.TgZ(0,"div",2)(1,"div",3),e.YNc(2,q,1,1,"app-panel-ruta",4),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.rutas)}}function N(n,r){1&n&&(e.TgZ(0,"div",6),e._UZ(1,"app-spiner"),e.qZA())}const J=[{path:"login",component:b,canActivate:[k]},{path:"home",component:S,canActivate:[m],children:[{path:"resumen",component:(()=>{class n{constructor(t,o){this.adminService=t,this.router=o,this.rutas=[],this.loading=!0}get user(){return{...this.adminService.user}}ngOnInit(){this.adminService.getAllRutaByAdmin().subscribe(t=>{this.rutas=t.rutas,this.loading=!1})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(c),e.Y36(s.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-resumen"]],decls:2,vars:2,consts:[["class","card",4,"ngIf"],["class","loading",4,"ngIf"],[1,"card"],[1,"flex","flex-column","gap-2"],[3,"ruta",4,"ngFor","ngForOf"],[3,"ruta"],[1,"loading"]],template:function(t,o){1&t&&(e.YNc(0,F,3,1,"div",0),e.YNc(1,N,2,0,"div",1)),2&t&&(e.Q6J("ngIf",!o.loading),e.xp6(1),e.Q6J("ngIf",o.loading))},dependencies:[l.sg,l.O5,O,L]}),n})(),canActivate:[m]},{path:"nueva-ruta",component:(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-nueva-ruta"]],decls:2,vars:0,template:function(t,o){1&t&&(e.TgZ(0,"p"),e._uU(1,"nueva-ruta works!"),e.qZA())}}),n})(),canActivate:[m]},{path:"nuevo-usuario",component:(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-nuevo-usuario"]],decls:2,vars:0,template:function(t,o){1&t&&(e.TgZ(0,"p"),e._uU(1,"nuevo-usuario works!"),e.qZA())}}),n})(),canActivate:[m]},{path:"ajustes",component:(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-ajustes"]],decls:2,vars:0,template:function(t,o){1&t&&(e.TgZ(0,"p"),e._uU(1,"ajustes works!"),e.qZA())}}),n})(),canActivate:[m]},{path:"**",redirectTo:"resumen"}]},{path:"**",redirectTo:"login"}];let G=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[s.Bz.forChild(J),s.Bz]}),n})();var Y=i(7507);let P=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[l.ez,G,Y.W,u.UX]}),n})()}}]);