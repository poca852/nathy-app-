"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[30],{4030:(V,h,i)=>{i.r(h),i.d(h,{AdminModule:()=>P});var p=i(6895),u=i(5649),c=i(433),Z=i(805),t=i(8256),l=i(529),A=i(2340),d=i(8505),f=i(4004),b=i(262),T=i(9646);let m=(()=>{class e{constructor(n,o){this.http=n,this.router=o,this.baseUrl=A.N.baseUrl}get user(){return{...this._user}}login({username:n,password:o}){const a=(new l.LE).append("admin",!0);return this.http.post(`${this.baseUrl}/auth/login`,{username:n,password:o},{params:a}).pipe((0,d.b)(({token:s})=>{s&&localStorage.setItem("token",s)}),(0,f.U)(s=>s.ok),(0,b.K)(s=>(0,T.of)(s.error.msg)))}revalidarToken(){const n=(new l.WM).set("x-token",localStorage.getItem("token")||""),o=(new l.LE).append("admin",!0);return this.http.get(`${this.baseUrl}/auth/revalidar`,{headers:n,params:o}).pipe((0,d.b)(({user:a,token:s})=>{this._user=a,localStorage.setItem("token",s)}),(0,f.U)(a=>a.ok),(0,b.K)(a=>(0,T.of)(!1)))}logout(){this._user=null,this.router.navigateByUrl("admin/login"),localStorage.clear()}getRutas(){const n=(new l.WM).set("x-token",localStorage.getItem("token")||"");return this.http.get(`${this.baseUrl}/rutas`,{headers:n})}getRuta(n){const o=(new l.WM).set("x-token",localStorage.getItem("token")||"");return this.http.get(`${this.baseUrl}/rutas/${n}`,{headers:o})}closeRuta(n){const o=(new l.WM).set("x-token",localStorage.getItem("token")||"");return this.http.patch(`${this.baseUrl}/rutas/close/${n}`,{},{headers:o})}openRuta(n){const o=(new l.WM).set("x-token",localStorage.getItem("token")||"");return this.http.patch(`${this.baseUrl}/rutas/open/${n}`,{},{headers:o})}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(l.eN),t.LFG(u.F0))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var U=i(1740),g=i(5593),x=i(7772);let y=(()=>{class e{constructor(n,o,a,s){this.adminService=n,this.fb=o,this.router=a,this.messageService=s,this.formLogin=this.fb.group({username:["",[c.kI.required]],password:["",[c.kI.required]]})}ngOnInit(){}login(){this.messageService.clear(),this.adminService.login(this.formLogin.value).subscribe(n=>{!0===n?this.router.navigateByUrl("/admin/home"):this.messageService.add({severity:"error",summary:n})})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(m),t.Y36(c.qu),t.Y36(u.F0),t.Y36(Z.ez))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-login"]],features:[t._Bn([Z.ez])],decls:14,vars:2,consts:[[1,"card"],[1,"card-container","flex","justify-content-center"],[1,"flex","gap-3","flex-column","p-3","mt-5",3,"formGroup","ngSubmit"],[1,"p-inputgroup"],[1,"p-inputgroup-addon"],[1,"pi","pi-user"],["type","text","pInputText","","placeholder","Username","formControlName","username"],[1,"pi","pi-key"],["type","password","pInputText","","placeholder","Password","formControlName","password"],["pButton","","label","Ingresar","type","submit",1,"col-12",3,"disabled"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"form",2),t.NdJ("ngSubmit",function(){return o.login()}),t.TgZ(3,"div",3)(4,"span",4),t._UZ(5,"i",5),t.qZA(),t._UZ(6,"input",6),t.qZA(),t.TgZ(7,"div",3)(8,"span",4),t._UZ(9,"i",7),t.qZA(),t._UZ(10,"input",8),t.qZA(),t.TgZ(11,"div",3),t._UZ(12,"button",9),t.qZA()()()(),t._UZ(13,"p-messages")),2&n&&(t.xp6(2),t.Q6J("formGroup",o.formLogin),t.xp6(10),t.Q6J("disabled",o.formLogin.invalid))},dependencies:[c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,U.o,g.Hq,x.V],styles:["form[_ngcontent-%COMP%]{border-radius:5px;border:thin solid gray}"]}),e})();function R(e,r){if(1&e&&(t.TgZ(0,"div",4)(1,"div",5),t._uU(2,"Ultimo cierre: "),t.qZA(),t.TgZ(3,"div",6),t._uU(4),t.qZA()()),2&e){const n=t.oxw();t.xp6(4),t.Oqu(n.ruta.ultimo_cierre)}}function S(e,r){if(1&e&&(t.TgZ(0,"div",4)(1,"div",5),t._uU(2,"Ultima apertura: "),t.qZA(),t.TgZ(3,"div",6),t._uU(4),t.qZA()()),2&e){const n=t.oxw();t.xp6(4),t.Oqu(n.ruta.ultima_apertura)}}const q=function(e){return["/admin/ruta",e]};let I=(()=>{class e{constructor(n){this.adminService=n}ngOnInit(){}closeRuta(n){n?this.adminService.closeRuta(this.ruta.id).subscribe(o=>window.location.reload()):this.adminService.openRuta(this.ruta.id).subscribe(o=>window.location.reload())}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(m))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-resumen-ruta"]],inputs:{ruta:"ruta"},decls:54,vars:35,consts:[[1,"text-layout","bg-blue-900","p-3","border-round"],[1,"flex","flex-column"],[1,"flex","align-items-center","justify-content-between"],["pButton","",1,"p-button-outlined",3,"ngClass","click"],[1,"grid"],[1,"col","flex","justify-content-end"],[1,"col"],["class","grid",4,"ngIf"],["pButton","","label","M\xe1s informaci\xf3n",1,"w-full","p-button-text","p-button-warning",3,"routerLink"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),t._uU(4),t.ALo(5,"titlecase"),t.qZA(),t.TgZ(6,"button",3),t.NdJ("click",function(){return o.closeRuta(o.ruta.status)}),t._uU(7),t.qZA()(),t.TgZ(8,"div",4)(9,"div",5),t._uU(10,"Clientes"),t.qZA(),t.TgZ(11,"div",6),t._uU(12),t.qZA()(),t.TgZ(13,"div",4)(14,"div",5),t._uU(15,"Cartera: "),t.qZA(),t.TgZ(16,"div",6),t._uU(17),t.ALo(18,"currency"),t.qZA()(),t.TgZ(19,"div",4)(20,"div",5),t._uU(21,"Prestamos: "),t.qZA(),t.TgZ(22,"div",6),t._uU(23),t.ALo(24,"currency"),t.qZA()(),t.TgZ(25,"div",4)(26,"div",5),t._uU(27,"Recaudo total: "),t.qZA(),t.TgZ(28,"div",6),t._uU(29),t.ALo(30,"currency"),t.qZA()(),t.TgZ(31,"div",4)(32,"div",5),t._uU(33,"Gastos: "),t.qZA(),t.TgZ(34,"div",6),t._uU(35),t.ALo(36,"currency"),t.qZA()(),t.TgZ(37,"div",4)(38,"div",5),t._uU(39,"Inversiones: "),t.qZA(),t.TgZ(40,"div",6),t._uU(41),t.ALo(42,"currency"),t.qZA()(),t.TgZ(43,"div",4)(44,"div",5),t._uU(45,"Retiros: "),t.qZA(),t.TgZ(46,"div",6),t._uU(47),t.ALo(48,"currency"),t.qZA()(),t.YNc(49,R,5,1,"div",7),t.YNc(50,S,5,1,"div",7),t.TgZ(51,"div",4)(52,"div",6),t._UZ(53,"button",8),t.qZA()()()()),2&n&&(t.xp6(4),t.Oqu(t.lcZ(5,13,o.ruta.nombre)),t.xp6(2),t.Q6J("ngClass",o.ruta.status?"p-button-success":"p-button-danger"),t.xp6(1),t.Oqu(o.ruta.status?"Abierta":"Cerrada"),t.xp6(5),t.Oqu(o.ruta.clientes),t.xp6(5),t.Oqu(t.xi3(18,15,o.ruta.cartera,"GTQ")),t.xp6(6),t.Oqu(t.xi3(24,18,o.ruta.total_prestado,"GTQ")),t.xp6(6),t.Oqu(t.xi3(30,21,o.ruta.total_cobrado,"GTQ")),t.xp6(6),t.Oqu(t.xi3(36,24,o.ruta.gastos,"GTQ")),t.xp6(6),t.Oqu(t.xi3(42,27,o.ruta.inversiones,"GTQ")),t.xp6(6),t.Oqu(t.xi3(48,30,o.ruta.retiros,"GTQ")),t.xp6(2),t.Q6J("ngIf",!o.ruta.status),t.xp6(1),t.Q6J("ngIf",o.ruta.status),t.xp6(3),t.Q6J("routerLink",t.VKq(33,q,o.ruta.id)))},dependencies:[p.mk,p.O5,u.rH,g.Hq,p.rS,p.H9]}),e})();var _=i(3214),L=i(1383);let C=(()=>{class e{constructor(n){this.adminService=n,this.openMenu=!1}get user(){return{...this.adminService.user}}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(m))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-sidebar"]],decls:11,vars:5,consts:[[1,"menu"],[1,"p-toolbar-group-left"],["pButton","","icon","pi pi-bars",1,"p-button-text","p-button-success",3,"click"],[1,"p-toolbar-group-right","text-layout"],[3,"visible","baseZIndex","visibleChange"],[1,"p-sidebar-lg"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"p-toolbar")(2,"div",1)(3,"button",2),t.NdJ("click",function(){return o.openMenu=!o.openMenu}),t.qZA()(),t.TgZ(4,"div",3)(5,"p"),t._uU(6),t.ALo(7,"titlecase"),t.qZA()()()(),t.TgZ(8,"p-sidebar",4),t.NdJ("visibleChange",function(s){return o.openMenu=s}),t.TgZ(9,"div",5),t._uU(10,"hola mundo"),t.qZA()()),2&n&&(t.xp6(6),t.Oqu(t.lcZ(7,3,o.user.nombre)),t.xp6(2),t.Q6J("visible",o.openMenu)("baseZIndex",1e6))},dependencies:[g.Hq,_.Y,L.o,p.rS],styles:[".menu[_ngcontent-%COMP%]{position:fixed;width:100%;top:0;left:0;z-index:5000}"]}),e})();function M(e,r){if(1&e&&(t.TgZ(0,"div"),t._UZ(1,"app-resumen-ruta",5),t.qZA()),2&e){const n=r.$implicit;t.xp6(1),t.Q6J("ruta",n)}}let O=(()=>{class e{constructor(n){this.adminService=n,this.rutas=[],this.loading=!1,this.openMenu=!1}get user(){return{...this.adminService.user}}ngOnInit(){this.adminService.getRutas().subscribe(({rutas:n})=>this.rutas=n)}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(m))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-resumen"]],decls:7,vars:1,consts:[[1,"main_resumen","flex","flex-column","justify-content-center"],[1,"rutas"],[1,"text-layout"],[1,"flex","flex-column","justify-content-center","gap-3"],[4,"ngFor","ngForOf"],[3,"ruta"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0),t._UZ(1,"app-sidebar"),t.TgZ(2,"div",1)(3,"h3",2),t._uU(4,"Rutas:"),t.qZA(),t.TgZ(5,"div",3),t.YNc(6,M,2,1,"div",4),t.qZA()()()),2&n&&(t.xp6(6),t.Q6J("ngForOf",o.rutas))},dependencies:[p.sg,I,C],styles:[".main-resumen[_ngcontent-%COMP%]{width:100vh}.rutas[_ngcontent-%COMP%]{margin-top:70px}"]}),e})(),v=(()=>{class e{constructor(n,o){this.adminService=n,this.router=o}canActivate(){return this.adminService.revalidarToken().pipe((0,d.b)(n=>{n||this.router.navigateByUrl("/admin/login")}))}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(m),t.LFG(u.F0))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),F=(()=>{class e{constructor(n,o){this.adminService=n,this.router=o}canActivate(){return this.adminService.revalidarToken().pipe((0,d.b)(n=>{n&&this.router.navigateByUrl("/admin/home")}),(0,f.U)(n=>!n))}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(m),t.LFG(u.F0))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),k=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-rutas"]],decls:2,vars:0,template:function(n,o){1&n&&(t.TgZ(0,"p"),t._uU(1,"rutas works!"),t.qZA())}}),e})(),w=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-usuarios"]],decls:2,vars:0,template:function(n,o){1&n&&(t.TgZ(0,"p"),t._uU(1,"usuarios works!"),t.qZA())}}),e})(),B=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-clientes"]],inputs:{ruta:"ruta"},decls:2,vars:0,template:function(n,o){1&n&&(t.TgZ(0,"p"),t._uU(1,"clientes works!"),t.qZA())}}),e})(),G=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-gastos"]],decls:2,vars:0,template:function(n,o){1&n&&(t.TgZ(0,"p"),t._uU(1,"gastos works!"),t.qZA())}}),e})();var J=i(3900),Y=i(7932);let Q=(()=>{class e{constructor(n){this.router=n,this.backBtn=""}ngOnInit(){}goBack(){this.router.navigateByUrl(this.backBtn)}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(u.F0))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-btn-volver"]],inputs:{backBtn:"backBtn"},decls:1,vars:0,consts:[["pButton","","icon","pi pi-arrow-left",1,"p-button-text",3,"click"]],template:function(n,o){1&n&&(t.TgZ(0,"button",0),t.NdJ("click",function(){return o.goBack()}),t.qZA())},dependencies:[g.Hq]}),e})();function N(e,r){if(1&e&&(t.TgZ(0,"div",2),t._UZ(1,"app-sidebar"),t.TgZ(2,"div",3),t._UZ(3,"app-btn-volver",4),t.TgZ(4,"h3",5),t._uU(5),t.ALo(6,"titlecase"),t.qZA()(),t.TgZ(7,"div",6),t._UZ(8,"router-outlet"),t.qZA()()),2&e){const n=t.oxw();t.xp6(3),t.Q6J("backBtn","/admin/home"),t.xp6(2),t.hij("Ruta: ",t.lcZ(6,2,n.ruta.nombre),"")}}function X(e,r){1&e&&(t.TgZ(0,"div",7),t._UZ(1,"p-progressSpinner"),t.qZA())}const j=[{path:"login",component:y,canActivate:[F]},{path:"home",component:O,canActivate:[v]},{path:"ruta/:id",component:(()=>{class e{constructor(n,o){this.adminService=n,this.activatedRoute=o,this.loading=!0}ngOnInit(){this.activatedRoute.params.pipe((0,J.w)(({id:n})=>this.adminService.getRuta(n))).subscribe(n=>{this.ruta=n.ruta,this.loading=!1})}ngOnDestroy(){this.ruta=null,this.loading=!0}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(m),t.Y36(u.gz))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-main-ruta"]],decls:2,vars:2,consts:[["class","card flex flex-column",4,"ngIf"],["class","loading",4,"ngIf"],[1,"card","flex","flex-column"],[1,"header","flex","align-items-center","flex-row","justify-content-between"],[3,"backBtn"],[1,"text-layout"],[1,"flex"],[1,"loading"]],template:function(n,o){1&n&&(t.YNc(0,N,9,4,"div",0),t.YNc(1,X,2,0,"div",1)),2&n&&(t.Q6J("ngIf",!o.loading),t.xp6(1),t.Q6J("ngIf",o.loading))},dependencies:[p.O5,u.lC,Y.G,C,Q,p.rS],styles:[".header[_ngcontent-%COMP%]{margin-top:70px}"]}),e})(),canActivate:[v],children:[{path:"clientes",component:B},{path:"gastos",component:G},{path:"**",redirectTo:"clientes"}]},{path:"rutas",component:k,canActivate:[v]},{path:"usuarios",component:w,canActivate:[v]},{path:"**",redirectTo:"login"}];let z=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[u.Bz.forChild(j),u.Bz]}),e})();var $=i(9658);let P=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[p.ez,c.UX,z,$.W]}),e})()}}]);